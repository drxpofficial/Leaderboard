# Environment Configuration

Create a `.env` file in your project root with the following variables:

## Database Configuration

```env
# Database Connection (from Synth Hosting)
DATABASE_URL="mysql://username:password@host:port/database"
```

**How to get this:**
- Follow the [Database Setup Guide](README_DATABASE.md)
- Remove the `jdbc:` prefix from Synth Hosting's JDBC connection string

## API Keys

```env
# API Keys for secure communication between your Rust plugin and the application
API_KEY="your_secure_api_key_here"
NEXT_PUBLIC_API_KEY="your_secure_api_key_here"
```

**Generate secure API keys:**
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

**Important Notes:**
- Use the same value for both `API_KEY` and `NEXT_PUBLIC_API_KEY`
- This key is used by your Rust plugin to authenticate with your leaderboard API
- Keep this key secure and don't share it publicly

## Steam API Configuration

```env
# Steam API Key for fetching player avatars and Steam data
STEAM_API_KEY="your_steam_api_key_here"
```

**How to get Steam API Key:**
1. Visit [Steam Web API Key](https://steamcommunity.com/dev/apikey)
2. Login with your Steam account
3. Enter your domain name (e.g., `localhost:3000` for development)
4. Copy the generated API key

## NextAuth Configuration

```env
# NextAuth Secret for session encryption
NEXTAUTH_SECRET="your_nextauth_secret_here"

# NextAuth URL (your application's URL)
NEXTAUTH_URL="http://localhost:3000"
```

**Generate NextAuth Secret:**
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

**NextAuth URL Values:**
- **Development**: `http://localhost:3000`
- **Production**: `https://yourdomain.com`

## Complete Example `.env.local`

```env
# Database
DATABASE_URL="mysql://user123:pass456@db.synthhosting.com:3306/leaderboard_db"

# API Keys (use same value for both)
API_KEY="a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"
NEXT_PUBLIC_API_KEY="a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"

# Steam API
STEAM_API_KEY="AB12CD34EF56GH78IJ90KL12MN34OP56QR78ST90"

# NextAuth
NEXTAUTH_SECRET="def456789012345678901234567890abcdef123456789012345678901234"
NEXTAUTH_URL="http://localhost:3000"
```

## Rust Plugin Setup (Stats.cs)

The included `Stats.cs` plugin sends player statistics from your Rust server to your leaderboard.

### Installation

1. **Install the plugin:**
   - Copy `Stats.cs` to your server's `oxide/plugins/` directory
   - The plugin will auto-compile on server restart

2. **Configure the plugin:**
   - After first load, edit `oxide/config/Stats.json`
   - Use the same API key generated above

### Plugin Configuration (`oxide/config/Stats.json`)

```json
{
  "Web API URL": "https://yourdomain.com",
  "Web API Key": "your_api_key_from_env_file",
  "Server ID (Unique identifier for this server)": "your_server_id",
  "Batch Interval (Seconds between sending batched events to API)": 5.0
}
```

**Configuration Options:**

- **`Web API URL`** - Your leaderboard domain (without `/api/stats`)
- **`Web API Key`** - Same value as `API_KEY` in your `.env` file
- **`Server ID`** - Unique identifier for this server (must match admin panel)
- **`Batch Interval`** - How often to send data (5.0 seconds recommended)

### Setup Steps

1. **Add your server in admin panel:**
   - Go to `/admin/servers` in your leaderboard
   - Click "Add Server"
   - Use the same `Server ID` as in your plugin config

2. **Test the connection:**
   - Plugin will log connection status to server console
   - Check for any API errors in server logs
   - Verify data appears in your leaderboard

### Tracked Events

The plugin automatically tracks:
- **Kills** - When a player eliminates another player
- **Deaths** - When a player is eliminated
- **Headshots** - Tracked with kill events
- **Time Played** - Session duration when players disconnect

### Troubleshooting

**No data in leaderboard:**
- Verify API URL doesn't end with `/api/stats`
- Check API key matches your `.env` file
- Ensure server ID exists in admin panel
- Check server console for API error messages 
